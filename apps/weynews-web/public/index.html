<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>NewsWey</title>
</head>
<body>
  <section style="max-width:1100px;margin:24px auto;padding:0 16px;">
  <h2 style="margin:0 0 12px 0;">Derniers articles</h2>
  <div id="news-list" style="display:grid;gap:12px;"></div>
</section>

<script>
(async () => {
  const box = document.getElementById('news-list');
  box.innerHTML = 'Chargement…';

  try {
    const r = await fetch('/api/home'); // renvoie un array d’articles
    const items = await r.json();

    if (!Array.isArray(items) || items.length === 0) {
      box.innerHTML = 'Aucun article.';
      return;
    }

    box.innerHTML = items.map(a => `
      <a href="/article.html?id=${encodeURIComponent(a.id)}"
         style="display:block;padding:14px;border:1px solid #334155;border-radius:10px;text-decoration:none;color:inherit;background:#111827;">
        <div style="font-weight:700;margin-bottom:6px;">${escapeHtml(a.title || '')}</div>
        <div style="opacity:.85">${escapeHtml(a.summary || '')}</div>
        <div style="margin-top:8px;opacity:.6;font-size:12px;">${escapeHtml(a.created || '')}</div>
      </a>
    `).join('');
  } catch (e) {
    box.innerHTML = 'Erreur chargement.';
  }

  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }
})();
</script>
</body>
</html>
